<section layout="row" style="position:relative; top:20px; padding-bottom:30px;" flex ng-controller="editHelpController"
style="max-width:90%">
    <style>
        .md-whiteframe-z1 {
            background-color: white;
        }
        .helpText{
            text-align: justify;
        }
    </style>
    <md-sidenav class="md-sidenav-left md-whiteframe-z1" md-component-id="left" md-is-locked-open="$mdMedia('min-width: 1200px')"
    style="height:818px;">


        <md-toolbar class="bg-medgrey">
            <h1 class="md-toolbar-tools">Existing Terms</h1>
            <a ng-href="/help/manage/new">New</a>
        </md-toolbar>

        <md-content layout-padding layout-margin>
            <md-list>
                <md-list-item ng-repeat="term in schemas" ng-click="viewHelp(term)">
                    <!--<a ng-href="/help/glossary/{{term._id}}">-->
                        {{term.schemaName}} ({{term.fields.length}})
                    <!--</a>-->
                    <md-divider ng-if="!$last"></md-divider>
                </md-list-item>
            </md-list>
        </md-content>
    </md-sidenav>


    <md-content flex layout-margin style="margin:0 30px 30px 30px;padding:0;background-color:transparent;">


        <div layout="column" layout-fill>
            <md-toolbar>
                <div class="md-toolbar-tools">
                    <span>Schema Help</span>
                    <span flex></span>
                    <!--<md-button>
                        Right Bar Button
                    </md-button>-->
                </div>
            </md-toolbar>
            <md-content class="md-padding">
                <div layout="column" layout-align="top center">
                    <div ng-if="mode=='edit' && document">
                        <form name="editForm" style="margin-top:10px" class="editForm">
                            <md-input-container>
                                <label>Schema Name</label>
                                <input name="schemaName" ng-model="document.schemaName" required md-maxlength="100" minlength="4">
                                <!--<div ng-messages="editForm.schemaName.$error" ng-show="editForm.schemaName.$dirty">
                                    <div ng-message="required">Please enter schema name!</div>
                                    <div ng-message="md-maxlength">That's too long!</div>
                                    <div ng-message="minlength">That's too short!</div>
                                </div>-->
                            </md-input-container>
                            <md-input-container>
                                <label>Title</label>
                                <input name="schemaTitle" ng-model="document.title" required md-maxlength="200" minlength="4">
                            </md-input-container>
                            <md-card>
                                <md-card-content>
                                <label>Schema Fields</label>
                                <div class="row" ng-repeat="field in document.fields">
                                    <div class="col-xs-12" >
                                        <md-whiteframe class="md-whiteframe-z1" layout>
                                            <div style="padding:20px;width:100%">
                                            <i class="fa fa-remove pull-right" style="cursor:pointer" ng-click="deleteField(field)"/>                                    
                                                <md-input-container>
                                                    <label>Field Name</label>
                                                    <input name="fieldName" ng-model="field.name" required md-maxlength="100" minlength="4">
                                                </md-input-container>
                                                <md-input-container>
                                                    <label>Field Title</label>
                                                    <input name="fieldTitle" ng-model="field.title" required md-maxlength="100" minlength="4">
                                                </md-input-container>
                                                <md-checkbox ng-model="field.embed" aria-label="Embed?">
                                                    static
                                                </md-checkbox>
                                                <md-checkbox ng-model="field.popup" aria-label="Embed?">
                                                    popup
                                                </md-checkbox>
                                                </br>
                                                
                                                <div class="km-control-group" name="type" required caption="Field Type">
                                                    <div afc-autocomplete name="fieldTypes" ng-model="field.type" source="options.fieldTypes" filter="genericFilter" style="max-width:150px"
                                                    mapping="genericMapping" selectbox="true" required></div>                                                    
                                                
                                                </div></br>
                                               <md-input-container>
                                                    <label>Help text</label>
                                                    <!--<input name="fieldHelpText" ng-model="field.helpText" required md-maxlength="10000" minlength="4">-->                                                    
                                                    <div km-rich-textbox name="helpText" ng-model="field.helpText" rows="6" 
                                                        placeholder="" locales="languages" required></div>
                                                </md-input-container>
                                               
                                            </div>
                                        </md-whiteframe>
                                        </br>
                                    </div>
                                </div>
                                 <section layout="row" layout-sm="column" layout-align="center center" layout-wrap>
                                    <md-button class="md-raised md-primary" ng-click="addField()"> <i class="fa fa-plus"></i> Add </md-button>
                                </section>
                                </md-card-content>
                            </md-card>
                           
                            <br>
                            <section layout="row" layout-sm="column" layout-align="center center" layout-wrap>
                                <md-button class="md-raised" ng-click="cancel()">Cancel</md-button>
                                <md-button class="md-raised md-primary" ng-click="saveHelp()" ng-disabled="editForm.$invalid">Save</md-button>
                            </section>
                        </form>
                    </div>
                    <div ng-if="mode=='read'">
                        <button type="button" class="btn btn-success pull-right" ng-click="editHelp()">
                            Edit
                        </button>
                        <section>
                            <legend name="termCation">{{document.title}}</legend>
                               <!--<h3>{{document.schemaName}}<h3>-->
                            <md-list>
                                <md-list-item class="md-3-line" ng-repeat="item in document.fields">
                                    <div class="md-list-item-text">
                                    <h3>{{item.title}}</h3>
                                    <p class="helpText" ng-bind-html="item.helpText|lstring"> </p>
                                    </div>
                                    <md-divider ng-if="!$last"></md-divider>
                                </md-list-item>
                            </md-list>
                        </section>
                        
                    </div>

                </div>
            </md-content>
        </div>
    </md-content>
</section>