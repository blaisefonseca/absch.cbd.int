<div ng-controller="myTasksCotroller" style="padding-top:20px;margin-top:20px;" class="well no-shadow thin-border bg-white">
<style type="text/css">
.header1{
	padding: 8px;
	margin-bottom:20px;
	line-height: 1.428571429;
	vertical-align: top;
	border-bottom: 2px solid #111;
	font-weight: bold;
}

</style>



	<div class="dash-header bg-red" >
		<h2>
			<!-- <a class="color-white fa-11 pull-right" style="position:relative;top:2px;margin-right:10px;" ng-click="startIntro()"> <i class="fa fa-youtube-play"></i></a> -->

			<i class="fa fa-retweet" style="font-size:20pt;position:relative;top:3px;"></i>&nbsp;
			<span class="title dropshadow">REQUESTS</span>
		</h2>
	</div>


	<div class="row" style="margin-bottom:20px;">
		<div class="col-xs-12">
			<div style="font-weight:bold;">Find out the status of records submitted for approval by the Publishing Authority.</div>
		</div>
	</div>



	<div class="registerpage-content">

		<div class="alert alert-danger" ng-show="__error">
			<strong>Error: </strong>{{__error}}
		</div>

		<div class="pull-left">
			<!-- <strong>Type:</strong> -->
			<div km-select ng-model="filterType" binding-type="string" placeholder="Record Type" items="options.filterTypes()"></div>
			<!-- <strong>Status:</strong> -->
			<div km-select ng-model="filterStatus" binding-type="string" placeholder="Record Status" items="options.filterStatus()"></div>
			<input type="text" ng-model="keywords" placeholder=" keyword " class="form-control keyword" style="width:250px;display:inline;">
		</div>
		<br>
		<br>



		<div class="table " style="margin-top:15px;">
			<div ng-show="tasks.length && !__error" >

				<div class="row header1" >
					<!-- <div class="col-xs-2"><span style="cursor:pointer;" ng-click="sortTable('workflow._id')">ID
					<i ng-show="sortTerm=='workflow._id'" ng:class="{true:'down-caret', false:'up-caret'}[orderList]"></i></div> -->

					<div class="col-xs-3"><span style="cursor:pointer;" ng-click="sortTable('workflow.data.metadata.schema')">Record Type</i>
						<i ng-show="sortTerm=='activity.name'" ng:class="{true:'down-caret', false:'up-caret'}[orderList]"></i></div>

					<div class="col-xs-5"><span style="cursor:pointer;" ng-click="sortTable('workflow.data.metadata.schema')">Title</i>
					<i ng-show="sortTerm=='activity.name'" ng:class="{true:'down-caret', false:'up-caret'}[orderList]"></i></div>

					<div class="col-xs-2"><span style="cursor:pointer;" ng-click="sortTable('workflow.createdOn')">Requested
					<i ng-show="sortTerm=='workflow.data.metadata.schema'" ng:class="{true:'down-caret', false:'up-caret'}[orderList]"></i></div>

					<div class="col-xs-2"><span style="cursor:pointer;" ng-click="sortTable('activity.name')">Status
					<i ng-show="sortTerm=='workflow.createdOn'" ng:class="{true:'down-caret', false:'up-caret'}[orderList]"></i></div>

				</div>

				<div  ng-repeat="task in tasks|filter:keywords|filter:filterByType|filter:filterByStatus|orderBy:sortTerm:orderList">


					<div class="row" ng-class="{'bg-danger':task.workflow.state!='completed'}" style="padding:10px;margin-bottom:10px;">
						<!-- <div class="col-xs-2 col-md-2 col-ls-2">
							<a style="text-transform:uppercase;white-space:nowrap;" href="" ng-click="tasksDisplay=!tasksDisplay; formLoading=false"  type="button">
								{{formatWID(task.workflow._id)}}</a>
							<div ng-switch="task.workflow.type.name">
								<em ng-switch-when="publishNationalRecord">Publishing request</em>
								<em ng-switch-when="publishReferenceRecord">Publishing request</em>
								<em ng-switch-default>*{{task.workflow.type.name|uppercase}}*</em>
							</div>
						</div> -->

						<div class="col-xs-3"> <!-- schema -->
							<i class="{{task.workflow.data.metadata.schema|schemaIcon}}" ng-class="{'color-red':task.workflow.state!='completed', 'color-green':task.workflow.state=='completed', 'color-grey':task.workflow.state=='completed' && task.activity.result.action=='reject' }" style="font-size:16pt;position:relative;top:3px;"></i>
								{{task.workflow.data.metadata.schema|schemaName}}
						</div>

						<div class="col-xs-5"> <!-- Description -->
							<strong ng-show="task.workflow.result.documentID||task.workflow.data.documentID"><a ng-href="/database/record?documentID={{task.workflow.result.documentID||task.workflow.data.documentID}}">{{task.workflow.data.title | lstring}}</a></strong>
							<strong ng-hide="task.workflow.result.documentID||task.workflow.data.documentID"><a href="#" ng-click="tasksDisplay=!tasksDisplay; formLoading=false;">{{task.workflow.data.title | lstring}}</a></strong>
							<span ng-show="task.workflow.data.additionalInfo">(additional info:-{{task.workflow.data.additionalInfo}})
						</div>


						<div class="col-xs-2"> <!-- Requested on -->
							<div>{{task.workflow.createdOn|date:'short'}}</div>
							<div><em> by {{task.workflow.createdBy_info.firstName}} {{task.workflow.createdBy_info.lastName}}</em></div>
						</div>

						<div class="col-xs-2" style="padding-left:0px"> <!-- Status -->
							<div ng-switch="task.workflow.state">
								<div ng-switch-when="completed">
									<div ng-show="task.activity.completedOn">
										<span ng-show="task.activity" ng-switch="task.activity.result.action">
											<span ng-switch-when="approve"><i class="glyphicon glyphicon-ok"></i> Approved</span>
											<span ng-switch-when="reject"><i class="glyphicon glyphicon-remove"></i> Rejected</span>
										</span>
										{{task.workflow.activities.name}}
									</div>
								</div>
							</div>
							<div ng-show="task.workflow.state!='completed'">

										<div ng-show="task.activity.name='publishRecord'">
											<a class="btn btn-danger" type="button" ng-click="tasksDisplay=!tasksDisplay; formLoading=false;">
												<strong><i ng-class="{'glyphicon glyphicon-plus-sign': !tasksDisplay, 'glyphicon glyphicon-minus-sign': tasksDisplay}"></i>
												Awaiting approval</strong></a></div>

										<div ng-hide="ask.activity.name='publishRecord'">{{activity.name}}*</div>

							</div>

							<!-- <a class="btn btn-danger"  ng-click="tasksDisplay=!tasksDisplay; formLoading=false" type="button">
								<i ng-class="{'glyphicon glyphicon-plus-sign': !tasksDisplay, 'glyphicon glyphicon-minus-sign': tasksDisplay}"></i>
							</a> -->
						</div>

					 <!-- <div style="text-align:end" class="col-xs-1" ng-hide="task.workflow.state=='completed'">

						</div>

					</div> -->


					<div ng-show="tasksDisplay"  class="col-xs-12" ng-show="tasksDisplay" style="padding:20px 20px 0 20px;" >
						<div task-id class="record-body"  load-task-data='formLoading' workflow-task-id="{{task.workflow._id}}" parent-watcher="dashboard" ></div>
					</div>



				</div>





			</div>
		</div>
		<div class="alert alert-success" ng-show="tasks.length==0">
			No Item is requiring your attention
		</div>
	</div>
	</div>
</div>
